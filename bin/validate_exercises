#!/usr/bin/env bash
#
# Validate if tests can run properly and the example implementation
# is passing the tests for each exercise

set -o errexit
set -o nounset

cd "$( dirname "${BASH_SOURCE[0]}" )/.."

mapfile -t exercises < <(
    jq -r '
        .exercises  as $exs 
        | ["concept","practice"][] 
        | . as $type 
        | $exs[$type][] 
        | "exercises/\($type)/\(.slug)"
    ' config.json
)

for exercise in "${exercises[@]}"; do
    bin/validate_one_exercise "$exercise"
    echo
done
    bin/validate_one_exercise "$exercise"
    echo
done < <(
    jq -r '
        .exercises  as $exs 
        | ["concept","practice"][] 
        | . as $type 
        | $exs[$type][] 
        | "exercises/\($type)/\(.slug)"
    ' config.json
)
